<!-- templates/index.html -->
<html lang="en">
  <head>
    <title>WebApp</title>
		<link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.7.3/socket.io.min.js"></script>
    <script type="text/javascript">
			var data
			var socket = io.connect('http://' + document.domain + ':' + location.port);
      socket.on( 'connect', function() {
        socket.emit( 'my event', {
          data: 'User Connected'
        } )
			} )

			setInterval(function() {
				socket.emit( 'getData' );
			}, 1000);

			socket.on( 'returnData', function( msg ) {
				windSpd  = msg["wind"]["speed"]
				windDir  = msg["wind"]["direction"]
				swellPer = msg["swell"]["period"]
				swellDir = msg["swell"]["direction"]
				swellHgt = msg["swell"]["height"] 
				data=msg
				//document.getElementById('output').innerHTML = JSON.stringify(data)
				turnArrow(windDir ,(windSpd*2.5),"windArrow" )
				turnArrow(swellDir,(swellHgt*31),"swellArrow")
				return data
			} )
			// rotate width name
			function turnArrow(r,w,name) {
				  let x = document.getElementById(name);
					x.style.transform = "rotate("+(r-90)+"deg)"
					x.style.width = w
			}
    </script>
	</head>
	<body>
		<p id="output"></p>
		<div class="container" style="position: relative;">
			<div class="background" style="z-index: 1; position: absolute; top: 0px; left: 0px;">
				<img id="bgimage" src="../static/background.png" style="max-width:500px; height:auto;">
			</div>
			<div class="fg" style="z-index: 2; position: absolute; top: 0px; left: 0px;">
				<div id="windData" style="position: absolute; top: 75px; left: 300px;">
					<img id="windArrow" src="../static/arrow.png" style="max-width:250px; height:auto;">	
				</div>
				<div id="swellData" style="position: absolute; top: 175px; left: 50px;">
					<img id="swellArrow" src="../static/arrow.png" style="max-width:250px; height:auto;">
				</div>
			</div>
		</div>
  </body>
</html>
